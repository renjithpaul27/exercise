sourceddlfile=r'C:\Users\Renjith.Paul\Desktop\exercise\exercise\FilelevelDDLchanges\actualddlfile.txt'
changecolfilename = r'C:\Users\Renjith.Paul\Desktop\exercise\exercise\FilelevelDDLchanges\changecoldetails.txt'
newddl =  r'C:\Users\Renjith.Paul\Desktop\exercise\exercise\FilelevelDDLchanges\newddlfile.txt'

eachexisddl=[]
eachchangeddl=[]
updddl = []

with  open(sourceddlfile) as fp:
    contents = fp.read()
    for entry in contents.split(';'):
        if len(entry) != 0:
            eachexisddl.append(entry.strip('\n'))


with  open(changecolfilename) as fpl:
    next(fpl)
    contents = fpl.read()
    for entry in contents.split('\n'):
        eachchangeddl.append(entry.split(','))    

for each in eachexisddl:
    for eachone in eachchangeddl:
        if eachone[0] in each:
            old_data = eachone[1] + ' ' + eachone[2]
            new_data = eachone[1] + ' ' + eachone[3]
            each = each.replace(old_data,new_data)
    updddl.append(each)

with open(newddl, 'w') as f:
    for item in updddl:
        item = item + ';'
        f.write("%s\n" % item)
